{% extends "inventory/base.html" %}
{% block content %}
<div class="container mt-4">
    <h2>Inventory</h2>

    <form method="get" class="mb-3">
        <input type="text" name="q" class="form-control" placeholder="Search medicines name, batch no..."
            value="{{ request.GET.q }}">
    </form>
    <table class="table table-bordered table-striped">
        <thead>
            <tr>
                <th>Medicine</th>
                <th>Batch No.</th>
                <th>Quantity</th>
                <th>Expiration Date</th>
                <th>Last Updated</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            {% for inv in inventories %}
            <tr>
                <td>{{ inv.medicine.generic_name }} ({{ inv.medicine.brand_name }})</td>
                <td>{{ inv.batch_number }}</td>
                <td>
                    {% if inv.quantity > 0 %}
                    {{ inv.quantity }}
                    {% else %}
                    <span class="text-danger">Out of Stock</span>
                    {% endif %}
                </td>
                <td>{{ inv.expiration_date }}</td>
                <td>{{ inv.last_updated }}</td>
                <td><a href="/inventory/{{inv.pk}}" class="btn btn-sm btn-primary">View</a></td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="5" class="text-center">No inventory records available.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    <div class="mt-3">
        {% if is_paginated %}
        <nav>
            <ul class="pagination">
                {% if page_obj.has_previous %}
                <li class="page-item">
                    <a class="page-link"
                        href="?page={{ page_obj.previous_page_number }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}">Previous</a>
                </li>
                {% endif %}
                {% for num in paginator.page_range %}
                <li class="page-item {% if page_obj.number == num %}active{% endif %}">
                    <a class="page-link"
                        href="?page={{ num }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}">{{num}}</a>
                </li>
                {% endfor %}
                {% if page_obj.has_next %}
                <li class="page-item">
                    <a class="page-link"
                        href="?page={{ page_obj.next_page_number }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}">Next</a>
                </li>
                {% endif %}
            </ul>
        </nav>
        {% endif %}
    </div>
</div>

{% endblock %}